DROP TABLE IF EXISTS CURSOS
;
DROP TABLE IF EXISTS TIPOS_CLIENTES
;
DROP TABLE IF EXISTS CLIENTES
;
DROP TABLE IF EXISTS TIPOS_INSTRUCTORES
;
DROP TABLE IF EXISTS INSTRUCTORES
;
DROP TABLE IF EXISTS TIPOS_CAT_GRAL
;
DROP TABLE IF EXISTS ADMINISTRATIVOS
;
DROP TABLE IF EXISTS BITACORA
;
DROP TABLE IF EXISTS CAT_GRAL
;
DROP TABLE IF EXISTS AULAS
;
DROP TABLE IF EXISTS DOCS_ALUMNOS
;
DROP TABLE IF EXISTS DOCS_NECESARIOS_ALUMNOS
;
DROP TABLE IF EXISTS REFERENCIAS
;
DROP TABLE IF EXISTS FAMILIA
;
DROP TABLE IF EXISTS ESTUDIOS_ALUMNO
;
DROP TABLE IF EXISTS ESTUDIOS
;
DROP TABLE IF EXISTS TIPOS_ESTUDIOS
;
DROP TABLE IF EXISTS CAPACIDADES_ALUMNOS
;
DROP TABLE IF EXISTS TIPOS_LICENCIA
;
DROP TABLE IF EXISTS CAPACIDADES
;
DROP TABLE IF EXISTS ESTADOS
;
DROP TABLE IF EXISTS MUNICIPIOS
;
DROP TABLE IF EXISTS ASENTAMIENTOS
;
DROP TABLE IF EXISTS DOMICILIOS
;
DROP TABLE IF EXISTS PERSONAS
;
DROP TABLE IF EXISTS ESTATUS
;
DROP TABLE IF EXISTS ALUMNOS
;
DROP TABLE IF EXISTS CERTIFICADOS
;

CREATE TABLE CURSOS
(
	ID_CURSO BIGINT NOT NULL,
	ID_AREA INTEGER NULL,
	ID_PROGR_ESTUDIOS INTEGER NULL,
	FECHA_INI DATE NULL,
	FECHA_FIN DATE NULL,
	ID_SEDE INTEGER NULL,
	HORA_INI VARCHAR(5) NULL,
	HORA_FIN VARCHAR(5) NULL,
	GRUPO INTEGER NULL,
	REFERENCIA VARCHAR(20) NULL,
	PRIMARY KEY (ID_CURSO),
	UNIQUE UQ_CURSOS_GRUPO(GRUPO),
	UNIQUE UQ_CURSOS_REFERENCIA(REFERENCIA)
) 
;


CREATE TABLE TIPOS_CLIENTES
(
	ID_TIPO_CLIENTE SMALLINT NOT NULL,
	NOMBRE VARCHAR(20) NULL,
	PRIMARY KEY (ID_TIPO_CLIENTE)
) 
;


CREATE TABLE CLIENTES
(
	ID_CLIENTE INTEGER NOT NULL,
	CLAVE VARCHAR(20) NULL,
	NOMBRE VARCHAR(50) NULL,
	RESPONSABLE VARCHAR(50) NULL,
	TELEFONO VARCHAR(30) NULL,
	EMAIL VARCHAR(30) NULL,
	ID_TIPO_CLIENTE SMALLINT NULL,
	PRIMARY KEY (ID_CLIENTE),
	KEY (ID_TIPO_CLIENTE)
) 
;


CREATE TABLE TIPOS_INSTRUCTORES
(
	ID_TIPO_INSTRUCTOR SMALLINT NOT NULL,
	NOMBRE VARCHAR(20) NULL,
	PRIMARY KEY (ID_TIPO_INSTRUCTOR)
) 
;


CREATE TABLE INSTRUCTORES
(
	ID_INSTRUCTOR INTEGER NOT NULL,
	NO_EMPLEADO VARCHAR(20) NULL,
	ID_TIPO_INSTRUCTOR SMALLINT NULL,
	ID_PERSONA INTEGER NULL,
	ID_DOMICILIO INTEGER NULL,
	PRIMARY KEY (ID_INSTRUCTOR),
	KEY (ID_TIPO_INSTRUCTOR),
	KEY (ID_DOMICILIO),
	KEY (ID_PERSONA)
) 
;


CREATE TABLE TIPOS_CAT_GRAL
(
	ID_CAT_GRAL SMALLINT NOT NULL,
	TIPO VARCHAR(20) NULL,
	PRIMARY KEY (ID_CAT_GRAL)
) 
;


CREATE TABLE ADMINISTRATIVOS
(
	ID_ADMIN INTEGER NOT NULL,
	NO_EMPLEADO VARCHAR(20) NULL,
	ID_PERSONA INTEGER NULL,
	ID_DOMICILIO INTEGER NULL,
	PRIMARY KEY (ID_ADMIN),
	KEY (ID_PERSONA),
	KEY (ID_DOMICILIO)
) 
;


CREATE TABLE BITACORA
(
	ID_BITACORA BIGINT NOT NULL,
	FECHA DATETIME NULL,
	IP VARCHAR(15) NULL,
	ID_USR INTEGER NULL,
	MENSAJE VARCHAR(50) NULL,
	ACCION VARCHAR(30) NULL,
	PRIMARY KEY (ID_BITACORA)
) 
;


CREATE TABLE CAT_GRAL
(
	ID_CAT_GRAL INTEGER NOT NULL,
	ID_TIPO_CAT_GRAL SMALLINT NULL,
	CVE_REGISTRO VARCHAR(30) NULL,
	DESC VARCHAR(50) NULL,
	ESTATUS VARCHAR(20) NULL,
	ACTIVO SMALLINT NULL,
	PRIMARY KEY (ID_CAT_GRAL),
	KEY (ID_TIPO_CAT_GRAL)
) 
;


CREATE TABLE AULAS
(
	ID_AULA INTEGER NOT NULL,
	ID_SEDE INTEGER NULL,
	CLAVE VARCHAR(30) NULL,
	DESC VARCHAR(30) NULL,
	CAPACIDAD INTEGER NULL,
	ACTIVO SMALLINT NULL,
	PRIMARY KEY (ID_AULA),
	KEY (ID_SEDE)
) 
;


CREATE TABLE DOCS_ALUMNOS
(
	ID_DOC INTEGER NULL,
	NOMBRE VARCHAR(30) NULL,
	RUTA VARCHAR(100) NULL,
	ID_ESTATUS SMALLINT NULL,
	ID_ALUMNO INTEGER NULL,
	KEY (ID_ALUMNO),
	KEY (ID_ESTATUS)
) 
;


CREATE TABLE DOCS_NECESARIOS_ALUMNOS
(
	ID_DOC_NEC SMALLINT NOT NULL,
	NOMBRE VARCHAR(30) NULL,
	PRIMARY KEY (ID_DOC_NEC)
) 
;


CREATE TABLE REFERENCIAS
(
	ID_REFERENCIA INTEGER NOT NULL,
	ID_PERSONA INTEGER NULL,
	ID_DOMICILIO INTEGER NULL,
	ID_ALUMNO INTEGER NULL,
	PRIMARY KEY (ID_REFERENCIA),
	KEY (ID_ALUMNO),
	KEY (ID_PERSONA),
	KEY (ID_DOMICILIO)
) 
;


CREATE TABLE FAMILIA
(
	ID_FAM INTEGER NOT NULL,
	CONYUGUE_NOMBRE VARCHAR(50) NULL,
	CONYUGUE_FECHA_NAC DATE NULL,
	HIJO_1_NOMBRE VARCHAR(50) NULL,
	HIJO_1_FECHA_NAC DATE NULL,
	HIJO_2_NOMBRE VARCHAR(50) NULL,
	HIJO_2_FECHA_NAC DATE NULL,
	PADRE_NOMBRE VARCHAR(50) NULL,
	PADRE_FECHA_NAC DATE NULL,
	MADRE_NOMBRE VARCHAR(50) NULL,
	MADRE_FECHA_NAC DATE NULL,
	PRIMARY KEY (ID_FAM)
) 
;


CREATE TABLE ESTUDIOS_ALUMNO
(
	ID_EST_ALU INTEGER NOT NULL,
	ID_ESTUDIO INTEGER NULL,
	ID_ALUMNO INTEGER NULL,
	PRIMARY KEY (ID_EST_ALU),
	KEY (ID_ALUMNO),
	KEY (ID_ESTUDIO)
) 
;


CREATE TABLE ESTUDIOS
(
	ID_ESTUDIOS INTEGER NOT NULL,
	INSTITUCION VARCHAR(50) NULL,
	FECHA_INI SMALLINT NULL,
	FECHA_FIN SMALLINT NULL,
	CERT VARCHAR(50) NULL,
	ID_TIPO_ESTUDIO SMALLINT NULL,
	PRIMARY KEY (ID_ESTUDIOS),
	KEY (ID_TIPO_ESTUDIO)
) 
;


CREATE TABLE TIPOS_ESTUDIOS
(
	ID_TIPO_ESTUDIOS SMALLINT NOT NULL,
	NOMBRE VARCHAR(20) NULL,
	PRIMARY KEY (ID_TIPO_ESTUDIOS)
) 
;


CREATE TABLE CAPACIDADES_ALUMNOS
(
	ID_CAP_ALU INTEGER NOT NULL,
	ID_CAPACIDADES INTEGER NULL,
	ID_ALUMNO INTEGER NULL,
	PRIMARY KEY (ID_CAP_ALU),
	KEY (ID_ALUMNO),
	KEY (ID_CAPACIDADES)
) 
;


CREATE TABLE TIPOS_LICENCIA
(
	ID_TIPO_LIC SMALLINT NOT NULL,
	DESC_TIPO_LIC VARCHAR(20) NULL,
	PRIMARY KEY (ID_TIPO_LIC)
) 
;


CREATE TABLE CAPACIDADES
(
	ID_CAPACIDAD INTEGER NOT NULL,
	ID_TIPO_LICENCIA SMALLINT NULL,
	TIPO_CAPACIDAD VARCHAR(50) NULL,
	AUTORIZADA VARCHAR(50) NULL,
	HORAS INTEGER NULL,
	FECHA_INIC DATE NULL,
	FECHA_FIN DATE NULL,
	ACREDITADA VARCHAR(15) NULL,
	PRIMARY KEY (ID_CAPACIDAD),
	KEY (ID_TIPO_LICENCIA)
) 
;


CREATE TABLE ESTADOS
(
	ID_ESTADO INTEGER NOT NULL,
	NOMBRE VARCHAR(50) NULL,
	PRIMARY KEY (ID_ESTADO)
) 
;


CREATE TABLE MUNICIPIOS
(
	ID_MUNICIPIO INTEGER NOT NULL,
	ID_ESTADO INTEGER NOT NULL,
	NOMBRE VARCHAR(50) NULL,
	PRIMARY KEY (ID_MUNICIPIO, ID_ESTADO),
	KEY (ID_ESTADO)
) 
;


CREATE TABLE ASENTAMIENTOS
(
	ID_ASENTAMIENTO INTEGER NOT NULL,
	ID_MUNICIPIO INTEGER NOT NULL,
	ID_ESTADO INTEGER NOT NULL,
	ID_CP SMALLINT NULL,
	NOMBRE VARCHAR(50) NULL,
	PRIMARY KEY (ID_ASENTAMIENTO, ID_MUNICIPIO, ID_ESTADO),
	KEY (ID_MUNICIPIO, ID_ESTADO)
) 
;


CREATE TABLE DOMICILIOS
(
	ID_DOMICILIO INTEGER NOT NULL,
	ID_ASENTAMIENTO INTEGER NULL,
	CALLE VARCHAR(30) NULL,
	NO_EXTERIOR VARCHAR(10) NULL,
	NO_INTERIOR VARCHAR(10) NULL,
	CP SMALLINT NULL,
	TELEFONO VARCHAR(20) NULL,
	ID_MUNICIPIO INTEGER NULL,
	ID_ESTADO INTEGER NULL,
	PRIMARY KEY (ID_DOMICILIO),
	KEY (ID_ASENTAMIENTO, ID_MUNICIPIO, ID_ESTADO)
) 
;


CREATE TABLE PERSONAS
(
	ID_PERSONA INTEGER NOT NULL,
	FECHA_NAC DATE NULL,
	LUGAR_NAC VARCHAR(50) NULL,
	CURP VARCHAR(20) NULL,
	RFC VARCHAR(20) NULL,
	IFE VARCHAR(20) NULL,
	PASAPORTE VARCHAR(30) NULL,
	EMAIL VARCHAR(50) NULL,
	NOMBRE VARCHAR(30) NULL,
	APELLIDO_P VARCHAR(30) NULL,
	APELLIDO_M VARCHAR(30) NULL,
	PRIMARY KEY (ID_PERSONA)
) 
;


CREATE TABLE ESTATUS
(
	ID_ESTATUS SMALLINT NOT NULL,
	DESC_ESTATUS VARCHAR(20) NULL,
	OBS_ESTATUS VARCHAR(20) NULL,
	PRIMARY KEY (ID_ESTATUS)
) 
;


CREATE TABLE ALUMNOS
(
	ID_ALUMNO INTEGER NOT NULL,
	MATRICULA VARCHAR(50) NULL,
	ID_ESTATUS SMALLINT NULL,
	ID_PERSONA INTEGER NULL,
	ID_DOMICILIO INTEGER NULL,
	ID_FAMILIA INTEGER NULL,
	PRIMARY KEY (ID_ALUMNO),
	UNIQUE UQ_ALUM_MAT(MATRICULA),
	KEY (ID_ESTATUS),
	KEY (ID_PERSONA),
	KEY (ID_DOMICILIO),
	KEY (ID_FAMILIA)
) 
;


CREATE TABLE CERTIFICADOS
(
	NO_CERTIFICADO VARCHAR(50) NULL,
	ID_ESTATUS SMALLINT NULL,
	FECHA_EMISION DATE NULL,
	FECHA_CANCELACION DATE NULL,
	MOTIVO_CANCELACION VARCHAR(150) NULL,
	ID_ALUMNO INTEGER NULL,
	ID_CERT INTEGER NOT NULL,
	PRIMARY KEY (ID_CERT),
	KEY (ID_ESTATUS),
	KEY (ID_ALUMNO)
) 
;





ALTER TABLE CLIENTES ADD CONSTRAINT FK_CTE_TP_CTE 
	FOREIGN KEY (ID_TIPO_CLIENTE) REFERENCES TIPOS_CLIENTES (ID_TIPO_CLIENTE)
;

ALTER TABLE INSTRUCTORES ADD CONSTRAINT FK_INSTR_T_INSTR 
	FOREIGN KEY (ID_TIPO_INSTRUCTOR) REFERENCES TIPOS_INSTRUCTORES (ID_TIPO_INSTRUCTOR)
;

ALTER TABLE INSTRUCTORES ADD CONSTRAINT FK_INSTR_DOM 
	FOREIGN KEY (ID_DOMICILIO) REFERENCES DOMICILIOS (ID_DOMICILIO)
;

ALTER TABLE INSTRUCTORES ADD CONSTRAINT FK_INSTR_PER 
	FOREIGN KEY (ID_PERSONA) REFERENCES PERSONAS (ID_PERSONA)
;

ALTER TABLE ADMINISTRATIVOS ADD CONSTRAINT FK_ADMIN_PER 
	FOREIGN KEY (ID_PERSONA) REFERENCES PERSONAS (ID_PERSONA)
;

ALTER TABLE ADMINISTRATIVOS ADD CONSTRAINT FK_ADMIN_DOM 
	FOREIGN KEY (ID_DOMICILIO) REFERENCES DOMICILIOS (ID_DOMICILIO)
;

ALTER TABLE CAT_GRAL ADD CONSTRAINT FK_CAT_GRAL_TIP 
	FOREIGN KEY (ID_TIPO_CAT_GRAL) REFERENCES TIPOS_CAT_GRAL (ID_CAT_GRAL)
;

ALTER TABLE AULAS ADD CONSTRAINT FK_AU_SED 
	FOREIGN KEY (ID_SEDE) REFERENCES CAT_GRAL (ID_CAT_GRAL)
;

ALTER TABLE DOCS_ALUMNOS ADD CONSTRAINT FK_DOCS_ALU 
	FOREIGN KEY (ID_ALUMNO) REFERENCES ALUMNOS (ID_ALUMNO)
;

ALTER TABLE DOCS_ALUMNOS ADD CONSTRAINT FK_DOCSALU_EST 
	FOREIGN KEY (ID_ESTATUS) REFERENCES ESTATUS (ID_ESTATUS)
;

ALTER TABLE REFERENCIAS ADD CONSTRAINT FK_REF_ALU 
	FOREIGN KEY (ID_ALUMNO) REFERENCES ALUMNOS (ID_ALUMNO)
;

ALTER TABLE REFERENCIAS ADD CONSTRAINT FK_REF_PER 
	FOREIGN KEY (ID_PERSONA) REFERENCES PERSONAS (ID_PERSONA)
;

ALTER TABLE REFERENCIAS ADD CONSTRAINT FK_REF_DOM 
	FOREIGN KEY (ID_DOMICILIO) REFERENCES DOMICILIOS (ID_DOMICILIO)
;

ALTER TABLE ESTUDIOS_ALUMNO ADD CONSTRAINT FK_ESTALU_ALU 
	FOREIGN KEY (ID_ALUMNO) REFERENCES ALUMNOS (ID_ALUMNO)
;

ALTER TABLE ESTUDIOS_ALUMNO ADD CONSTRAINT FK_ESTALU_EST 
	FOREIGN KEY (ID_ESTUDIO) REFERENCES ESTUDIOS (ID_ESTUDIOS)
;

ALTER TABLE ESTUDIOS ADD CONSTRAINT FK_EST_TE 
	FOREIGN KEY (ID_TIPO_ESTUDIO) REFERENCES TIPOS_ESTUDIOS (ID_TIPO_ESTUDIOS)
;

ALTER TABLE CAPACIDADES_ALUMNOS ADD CONSTRAINT FK_CAPALU_ALU 
	FOREIGN KEY (ID_ALUMNO) REFERENCES ALUMNOS (ID_ALUMNO)
;

ALTER TABLE CAPACIDADES_ALUMNOS ADD CONSTRAINT FK_CAPALU_CAP 
	FOREIGN KEY (ID_CAPACIDADES) REFERENCES CAPACIDADES (ID_CAPACIDAD)
;

ALTER TABLE CAPACIDADES ADD CONSTRAINT FK_CAP_TL 
	FOREIGN KEY (ID_TIPO_LICENCIA) REFERENCES TIPOS_LICENCIA (ID_TIPO_LIC)
;

ALTER TABLE MUNICIPIOS ADD CONSTRAINT FK_MPIO_EDO 
	FOREIGN KEY (ID_ESTADO) REFERENCES ESTADOS (ID_ESTADO)
;

ALTER TABLE ASENTAMIENTOS ADD CONSTRAINT FK_ASEN_MPIO 
	FOREIGN KEY (ID_MUNICIPIO, ID_ESTADO) REFERENCES MUNICIPIOS (ID_MUNICIPIO, ID_ESTADO)
;

ALTER TABLE DOMICILIOS ADD CONSTRAINT FK_DOM_ASE 
	FOREIGN KEY (ID_ASENTAMIENTO, ID_MUNICIPIO, ID_ESTADO) REFERENCES ASENTAMIENTOS (ID_ASENTAMIENTO, ID_MUNICIPIO, ID_ESTADO)
;

ALTER TABLE ALUMNOS ADD CONSTRAINT FK_ALUM_EST 
	FOREIGN KEY (ID_ESTATUS) REFERENCES ESTATUS (ID_ESTATUS)
;

ALTER TABLE ALUMNOS ADD CONSTRAINT FK_ALUM_DT 
	FOREIGN KEY (ID_PERSONA) REFERENCES PERSONAS (ID_PERSONA)
;

ALTER TABLE ALUMNOS ADD CONSTRAINT FK_ALUM_DOM 
	FOREIGN KEY (ID_DOMICILIO) REFERENCES DOMICILIOS (ID_DOMICILIO)
;

ALTER TABLE ALUMNOS ADD CONSTRAINT FK_ALU_FAM 
	FOREIGN KEY (ID_FAMILIA) REFERENCES FAMILIA (ID_FAM)
;

ALTER TABLE CERTIFICADOS ADD CONSTRAINT FK_CERT_ESTATUS 
	FOREIGN KEY (ID_ESTATUS) REFERENCES ESTATUS (ID_ESTATUS)
;

ALTER TABLE CERTIFICADOS ADD CONSTRAINT FK_CERT_ALUMN 
	FOREIGN KEY (ID_ALUMNO) REFERENCES ALUMNOS (ID_ALUMNO)
;
